<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:p="http://primefaces.org/ui"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:c="http://java.sun.com/jsp/jstl/core">

    <f:view>
        <h:form id="form_photo_capture">
            <p:dialog widgetVar="dlg_photo_capture" header="Captura de Imagem" visible="#{photoCapture.renderedPhotoCapture}">
                <c:if test="#{!controleAcessoBean.verificarPermissao('libera_camera', 1)}">
                    <script type="text/javascript">
                        try {
                            navigator.getMedia = (navigator.getUserMedia ||
                                    navigator.webkitGetUserMedia ||
                                    navigator.mozGetUserMedia ||
                                    navigator.msGetUserMedia);

                            // permissoes
                            navigator.getMedia(
                                    {
                                        video: true
                                                // audio: true
                                    },
                                    function (localMediaStream) {
                                        var video = document.querySelector('video');
                                        video.src = window.URL.createObjectURL(localMediaStream);
                                        video.onloadedmetadata = function (e) {
                                        };
                                    },
                                    function (err) {
                                        console.log("O seguinte erro ocorreu: " + err);
                                    }
                            );
                        } catch (e) {

                        }
                    </script>
                </c:if>
                <p:ajax event="close" listener="#{photoCapture.close()}" />
                <h:panelGrid id="photo_capture_panel_imagem" columns="1" rendered="#{!controleAcessoBean.verificarPermissao('libera_camera', 1)}">
                    <p:photoCam widgetVar="pc" listener="#{photoCapture.capturar}" update="#{photoCapture.update}" style="width: 500px" forceFlash="#{segurancaUtilitariosBean.sessaoUsuario.cameraFlashPlayer}" />
                    <h:column> 
                        <p:commandButton type="button" value="CAPTURAR">
                            <p:ajax event="click" oncomplete="PF('pc').capture();"/>
                        </p:commandButton>
                    </h:column>
                </h:panelGrid>
            </p:dialog>         
        </h:form>
    </f:view>
</ui:composition>